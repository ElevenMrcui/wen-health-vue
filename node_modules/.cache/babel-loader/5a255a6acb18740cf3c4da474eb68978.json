{"remainingRequest":"D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaProgram\\VSCode\\health114_vue\\src\\views\\appoment\\ordersetting.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaProgram\\VSCode\\health114_vue\\src\\views\\appoment\\ordersetting.vue","mtime":1604539609003},{"path":"D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1604539599577},{"path":"D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1604539598881},{"path":"D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1604539599577},{"path":"D:\\JavaProgram\\VSCode\\health114_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1604539608318}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJkYXk6IG5ldyBEYXRlKCksCiAgICAgIHNldHRpbmdEYXRhOiB7fSwKICAgICAgc2V0dGluZ0RheTogJycsCiAgICAgIHNldHRpbmdEaWFsb2c6IGZhbHNlLAogICAgICBudW1iZXI6ICcnCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYmVmb3JlQXZhdGFyVXBsb2FkOiBmdW5jdGlvbiBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgewogICAgICB2YXIgaXNYbHN4ID0gZmlsZS50eXBlID09PSAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnOwoKICAgICAgaWYgKCFpc1hsc3gpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCflv4XpobvkuIrkvKB4bHN45paH5Lu2Jyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpc1hsc3g7IC8vICAg6L+U5Zue5YC85Yaz5a6aIOaWh+S7tuaYr+WQpuS4iuS8oCBhY3Rpb24g5aaC5p6cIHRydWUgIOiHquWKqOWQkWFjdGlvbuWPkemAgeaWh+S7tuS4iuS8oOivt+axggogICAgfSwKICAgIC8v5LiK5Lyg5oiQ5Yqf5o+Q56S6CiAgICBoYW5kbGVTdWNjZXNzOiBmdW5jdGlvbiBoYW5kbGVTdWNjZXNzKHJlc3BvbnNlLCBmaWxlKSB7CiAgICAgIGlmIChyZXNwb25zZS5mbGFnKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5tZXNzYWdlLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwb25zZS5tZXNzYWdlKTsKICAgICAgfQogICAgfSwKICAgIGdvU2V0dGluZzogZnVuY3Rpb24gZ29TZXR0aW5nKGRheSkgewogICAgICB0aGlzLnNldHRpbmdEYXkgPSBkYXk7CiAgICAgIHRoaXMuc2V0dGluZ0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgbG9hZERhdGE6IGZ1bmN0aW9uIGxvYWREYXRhKCkgewogICAgICAvL+WQjuWPsOaVsOaNruWKoOi9vQogICAgICAvLyAgIHRoaXMuY3VyZGF5ICDlj4zlkJHnu5HlrpogIOW9k+WJjeacgOaWsOeahOaXpeacnwogICAgICBjb25zb2xlLmxvZygn5pyA5paw5pel5pyfJywgdGhpcy5jdXJkYXkpOwogICAgICB0aGlzLmZpbmRTZXR0aW5nRGF0YSh0aGlzLmN1cmRheS5nZXRGdWxsWWVhcigpLCB0aGlzLmN1cmRheS5nZXRNb250aCgpICsgMSk7CiAgICB9LAogICAgZG93bmxvYWRUZW1wbGF0ZTogZnVuY3Rpb24gZG93bmxvYWRUZW1wbGF0ZSgpIHsKICAgICAgLy93aW5kb3cub3Blbih1cmwsdGFyZ2V0KSAKICAgICAgLy90YXJnZXQ6X2JsYW5r5paw56qX5Y+jLF9wYXJlbnTmnKznqpflj6MsX3NlbGbmm7/mjaLlvZPliY3pobXpnaIKICAgICAgd2luZG93Lm9wZW4oJ2FwaS90ZW1wbGF0ZS9vcmRlcnNldHRpbmdfdGVtcGxhdGUueGxzeCcsICdfcGFyZW50Jyk7CiAgICB9LAogICAgZmluZFNldHRpbmdEYXRhOiBmdW5jdGlvbiBmaW5kU2V0dGluZ0RhdGEoeWVhciwgbW9udGgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGh0dHAuZ2V0KCJhcGkvb3JkZXJzZXR0aW5nL2ZpbmRTZXR0aW5nRGF0YS8iICsgeWVhciArICIvIiArIG1vbnRoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLmRhdGEuZmxhZykgewogICAgICAgICAgX3RoaXMuc2V0dGluZ0RhdGEgPSByZXMuZGF0YS5kYXRhOwoKICAgICAgICAgIF90aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLmRhdGEubWVzc2FnZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5kYXRhLm1lc3NhZ2UpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgLy8gIOebkeWQrCDlvZPliY0g5pel5pyf55qE5Y+Y5YyWICBjdXJkYXkgCiAgICBjdXJkYXk6IGZ1bmN0aW9uIGN1cmRheShvbGREYXRlLCBuZXdEYXRlKSB7CiAgICAgIC8v5Yik5pat5aaC5p6c5pel5pyf5Y+Y5YyW5ZCO77yM5LiN5piv55u45ZCM5pyI5Lu95bCx6Kem5Y+R5ZCO5Y+w5pWw5o2u5Yqg6L29CiAgICAgIGlmIChvbGREYXRlLmdldE1vbnRoKCkgIT0gbmV3RGF0ZS5nZXRNb250aCgpKSB7CiAgICAgICAgdGhpcy5sb2FkRGF0YSgpOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgLy8gdGhpcy5zZXR0aW5nRGF0YSA9IHsKICAgIC8vICAgIjIwMjAtMDktMDEiOntudW1iZXI6MjAwLHJlc2VydmF0aW9uczoyMDB9LAogICAgLy8gICAiMjAyMC0wOS0wMiI6e251bWJlcjoyMDAscmVzZXJ2YXRpb25zOjIwMH0sCiAgICAvLyAgICIyMDIwLTA5LTA1Ijp7bnVtYmVyOjIwMCxyZXNlcnZhdGlvbnM6MTAwfSwKICAgIC8vICAgIjIwMjAtMDktMTUiOntudW1iZXI6MjAwLHJlc2VydmF0aW9uczo1MH0sCiAgICAvLyAgICIyMDIwLTA5LTI4Ijp7bnVtYmVyOjEwMCxyZXNlcnZhdGlvbnM6OTB9CiAgICAvLyB9CiAgICB0aGlzLmZpbmRTZXR0aW5nRGF0YSh0aGlzLmN1cmRheS5nZXRGdWxsWWVhcigpLCB0aGlzLmN1cmRheS5nZXRNb250aCgpICsgMSk7CiAgfQp9Ow=="},{"version":3,"sources":["ordersetting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,IAAA,IAAA,EADA;AAEA,MAAA,WAAA,EAAA,EAFA;AAGA,MAAA,UAAA,EAAA,EAHA;AAIA,MAAA,aAAA,EAAA,KAJA;AAKA,MAAA,MAAA,EAAA;AALA,KAAA;AAOA,GATA;AAUA,EAAA,OAAA,EAAA;AACA,IAAA,kBADA,8BACA,IADA,EACA;AACA,UAAA,MAAA,GAAA,IAAA,CAAA,IAAA,KAAA,mEAAA;;AACA,UAAA,CAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,YAAA;AACA;;AACA,aAAA,MAAA,CALA,CAKA;AACA,KAPA;AAQA;AACA,IAAA,aATA,yBASA,QATA,EASA,IATA,EASA;AACA,UAAA,QAAA,CAAA,IAAA,EAAA;AACA,aAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,QAAA,CAAA,OADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA,OALA,MAKA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,QAAA,CAAA,OAAA;AACA;AAEA,KAnBA;AAoBA,IAAA,SAAA,EAAA,mBAAA,GAAA,EAAA;AACA,WAAA,UAAA,GAAA,GAAA;AACA,WAAA,aAAA,GAAA,IAAA;AACA,KAvBA;AAwBA,IAAA,QAAA,EAAA,oBAAA;AAAA;AACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,MAAA,EAAA,KAAA,MAAA;AACA,WAAA,eAAA,CAAA,KAAA,MAAA,CAAA,WAAA,EAAA,EAAA,KAAA,MAAA,CAAA,QAAA,KAAA,CAAA;AACA,KA5BA;AA6BA,IAAA,gBAAA,EAAA,4BAAA;AACA;AACA;AACA,MAAA,MAAA,CAAA,IAAA,CAAA,yCAAA,EAAA,SAAA;AACA,KAjCA;AAkCA,IAAA,eAlCA,2BAkCA,IAlCA,EAkCA,KAlCA,EAkCA;AAAA;;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,sCAAA,IAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,UAAA,KAAA,CAAA,WAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA;;AACA,UAAA,KAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,IAAA,CAAA,OAAA;AACA,SAHA,MAGA;AACA,UAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,IAAA,CAAA,OAAA;AACA;AACA,OAPA;AAQA;AA3CA,GAVA;AAwDA,EAAA,KAAA,EAAA;AACA;AACA,IAAA,MAAA,EAAA,gBAAA,OAAA,EAAA,OAAA,EAAA;AACA;AACA,UAAA,OAAA,CAAA,QAAA,MAAA,OAAA,CAAA,QAAA,EAAA,EAAA;AACA,aAAA,QAAA;AACA;AACA;AAPA,GAxDA;AAiEA,EAAA,OAjEA,qBAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAAA,eAAA,CAAA,KAAA,MAAA,CAAA,WAAA,EAAA,EAAA,KAAA,MAAA,CAAA,QAAA,KAAA,CAAA;AAEA;AA5EA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"content-header\">\r\n      <h1>\r\n        预约管理\r\n        <small>预约设置</small>\r\n      </h1>\r\n      <el-breadcrumb separator-class=\"el-icon-arrow-right\" class=\"breadcrumb\">\r\n        <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n        <el-breadcrumb-item>预约管理</el-breadcrumb-item>\r\n        <el-breadcrumb-item>预约设置</el-breadcrumb-item>\r\n      </el-breadcrumb>\r\n    </div>\r\n    <div class=\"app-container\">\r\n      <div class=\"box\">\r\n        <div class=\"ordersetting\">\r\n          <el-card class=\"box-card\">\r\n            <div class=\"boxMain\">\r\n              <el-button style=\"margin-bottom: 20px;margin-right: 20px\" type=\"primary\" @click=\"downloadTemplate\">模板下载</el-button>\r\n              <el-upload\r\n                action=\"api/ordersetting/importOrderSettings\"\r\n                name=\"excelFile\"\r\n                :before-upload=\"beforeAvatarUpload\"\r\n                :on-success=\"handleSuccess\"\r\n                :show-file-list=\"false\"\r\n              >\r\n                <el-button type=\"primary\">上传文件</el-button>\r\n              </el-upload>\r\n            </div>\r\n            <div>\r\n              操作说明：请点击\"模板下载\"按钮获取模板文件，在模板文件中录入预约设置数据\r\n              <span style=\"color: red\">(日期格式为：yyyy/MM/dd)</span>后点击\"上传文件\"按钮上传模板文件。\r\n            </div>\r\n          </el-card>\r\n          <el-calendar v-model=\"curday\">\r\n            <template\r\n              slot=\"dateCell\"\r\n              slot-scope=\"{date, data}\">\r\n              <div v-if=\"settingData[data.day]\">\r\n                <div v-if=\"settingData[data.day].number == settingData[data.day].reservations\" \r\n                  style=\"background-color:red;height:85px;\">\r\n                 <div><font color='blue'>{{data.day}}</font></div>\r\n                  <div>{{settingData[data.day].reservations}}/{{settingData[data.day].number}}</div>\r\n                  <div>已满</div>\r\n                </div>\r\n                <div v-else style=\"background-color:lightblue;height:85px;\">\r\n                  <div><font color='blue'>{{data.day}}</font></div>\r\n                  <div>{{settingData[data.day].reservations}}/{{settingData[data.day].number}}</div>\r\n                  <div><button\r\n                   @click=\"goSetting(data.day)\"><i class=\"el-icon-setting\"></i>设置</button></div>\r\n                </div>\r\n              </div>\r\n              <div v-else>\r\n                <div v-if=\"data.type == 'current-month'\" style=\"padding-top:25px;\">\r\n                    <font color='blue'>{{data.day}}</font>\r\n                    <button @click=\"goSetting(data.day)\"><i class=\"el-icon-setting\"></i>设置</button>\r\n                </div>\r\n                <div v-else style=\"background-color:rgb(192,196,204);height:85px;width100%;\">\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </el-calendar>\r\n        </div>\r\n      </div>\r\n    </div>\r\n     <el-dialog title=\"预约设置\" :visible.sync=\"settingDialog\" width=\"30%\" top=\"15%\">\r\n       <div>日期:{{settingDay}}</div>\r\n       <el-input v-model=\"number\" placeholder=\"输入预约总人数\"></el-input>\r\n       <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"settingDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"settingDialog = false\">确定</el-button>\r\n      </div>\r\n     </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      curday: new Date(),\r\n      settingData:{},\r\n      settingDay:'',\r\n      settingDialog:false,\r\n      number:'',\r\n    };\r\n  },\r\n  methods:{\t\r\n     beforeAvatarUpload(file) {\r\n                    const isXlsx = file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\r\n                    if (!isXlsx) {\r\n                        this.$message.error('必须上传xlsx文件');\r\n                    }\r\n                    return isXlsx ; //   返回值决定 文件是否上传 action 如果 true  自动向action发送文件上传请求\r\n                },\r\n    //上传成功提示\r\n                handleSuccess(response, file) {\r\n                    if(response.flag){\r\n                        this.$message({\r\n                            message: response.message,\r\n                            type: 'success'\r\n                        });\r\n                    }else{\r\n                        this.$message.error(response.message);\r\n                    }\r\n                   \r\n                },\r\n    goSetting:function(day){\r\n        this.settingDay = day;\r\n        this.settingDialog = true;\r\n    },\r\n    loadData:function(){//后台数据加载\r\n    //   this.curday  双向绑定  当前最新的日期\r\n      console.log('最新日期',this.curday);\r\n      this.findSettingData(this.curday.getFullYear(),this.curday.getMonth()+1)\r\n    },\r\n    downloadTemplate:function(){\r\n      //window.open(url,target) \r\n      //target:_blank新窗口,_parent本窗口,_self替换当前页面\r\n      window.open('api/template/ordersetting_template.xlsx','_parent');\r\n    },\r\n    findSettingData(year,month){\r\n        this.$http.get(\"api/ordersetting/findSettingData/\"+year+\"/\"+month).then((res)=>{\r\n        if(res.data.flag){\r\n          this.settingData = res.data.data\r\n          this.$message.success(res.data.message)\r\n        }else{\r\n          this.$message.error(res.data.message)\r\n        }\r\n    })\r\n    }\r\n    \r\n  },\r\n  watch:{\r\n    //  监听 当前 日期的变化  curday \r\n    curday:function(oldDate,newDate){\r\n      //判断如果日期变化后，不是相同月份就触发后台数据加载\r\n      if(oldDate.getMonth() != newDate.getMonth()){\r\n        this.loadData();\r\n      }\r\n    }\r\n  },\r\n  created(){\r\n    // this.settingData = {\r\n    //   \"2020-09-01\":{number:200,reservations:200},\r\n    //   \"2020-09-02\":{number:200,reservations:200},\r\n    //   \"2020-09-05\":{number:200,reservations:100},\r\n    //   \"2020-09-15\":{number:200,reservations:50},\r\n    //   \"2020-09-28\":{number:100,reservations:90}\r\n    // }\r\n\r\n     this.findSettingData(this.curday.getFullYear(),this.curday.getMonth()+1)\r\n\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.el-calendar-table .el-calendar-day{\r\n  padding: 0;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/appoment"}]}